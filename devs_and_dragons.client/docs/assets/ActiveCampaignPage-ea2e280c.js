import{s as T,A as l,l as p,_ as Q,r as W,u as X,b as Z,k as $,w as aa,v as ea,P as _,x as ta,j as Y,d as u,e as G,o as i,c as s,f as t,g as r,t as y,F as I,i as C,m as h,y as k,p as ca,q as ia}from"./index-37c54890.js";class K{constructor(n){this.campaignId=n.campaignId,this.accountId=n.accountId,this.Campaign=n.Campaign,this.Profile=n.Profile}}class sa{async getAccountCampaignLinks(n){const a=(await T.get(`api/campaigns/${n}/accountcampaignlinks`)).data.map(b=>new K(b));l.AccountLinks=a}async createAccountLink(n){const g=await T.post("api/accountcampaignlinks",n);p.log("created account link",g.data),l.AccountLinks.push(new K(g.data))}}const O=new sa;const na={setup(){W({});const o=X();Z(()=>{a(),b(),n(),g(),$.getEntity()}),aa(()=>{n(),g()});async function n(){try{const c=o.params.campaignId;await ea.getEntityLinksByCampaign(c)}catch(c){_.error(c.message),p.log(c)}}async function g(){try{const c=o.params.campaignId;await ta.getNotesByCampaign(c)}catch(c){_.error(c.message),p.log(c)}}async function a(){try{const c=o.params.campaignId;await Y.getActiveCampaign(c)}catch(c){_.error(c.message),p.log(c)}}async function b(){try{const c=o.params.campaignId;p.log("here is the campaign id on page",c),await O.getAccountCampaignLinks(c)}catch(c){_.error(c.message),p.log(c)}}return{notes:u(()=>l.Notes),campaign:u(()=>l.activeCampaign),accountLinks:u(()=>l.AccountLinks),entityLinks:u(()=>l.entityLinks),account:u(()=>l.account),formattedDate:u(()=>{var c;return(c=l.activeCampaign)==null?void 0:c.nextSessionDate.toLocaleDateString()}),hasLink:u(()=>l.AccountLinks.find(c=>c.accountId==l.account.id)),async createAccountLink(){try{const w={campaignId:o.params.campaignId};await O.createAccountLink(w)}catch(c){_.error(c.message),p.log(c)}},async archiveCampaign(){try{if(await _.confirm("Are you sure you want to archive this campaign? You will not be able to undo this.")){const c=o.params.campaignId;await Y.archiveCampaign(c)}return}catch(c){_.error(c.message)}}}}},m=o=>(ca("data-v-fc9ee395"),o=o(),ia(),o),oa={class:"container-fluid background"},da={class:"row"},ra={class:"col-md-2 col-12 d-flex align-items-center"},la={key:0},ma=["href"],ga=m(()=>t("img",{class:"discord",src:"https://logo.com/image-cdn/images/kts928pd/production/5b24e49fd89287ff1eb5bbc4cf93cb038c3384ef-512x512.png?w=1080&q=72",alt:""},null,-1)),_a=[ga],ua={key:1},pa=m(()=>t("img",{"data-bs-toggle":"modal","data-bs-target":"#discordUpdate",class:"discord selectable",title:"Update Discord",src:"https://static.vecteezy.com/system/resources/previews/011/912/003/original/plus-sign-icon-free-png.png",alt:""},null,-1)),ha=[pa],va={class:"col-md-8 col-12"},fa={class:"text-white text-center d-flex flex-column align-items-center pt-3"},ya={key:0},ka={key:1,class:"text-warning"},ba={class:"col-md-2 col-12 d-flex justify-content-center align-items-center"},Ia=["hidden"],Ca={class:"row"},wa={class:"col-12 d-flex justify-content-around p-4"},La=["src","alt","title"],xa={class:"row"},Aa=m(()=>t("div",{class:"col-2 order-0"},null,-1)),Sa={class:"col-12 col-md-7 rounded elevation-5 child-field order-2 order-md-1"},Ea={class:"col-12 col-md-3 bg-dark text-light text-center top-menu order-1 order-md-2"},Pa=m(()=>t("h1",{class:"selectable mt-3 text-light"},"Description",-1)),Da={class:"d-flex justify-content-around align-items-center fs-4"},Na=m(()=>t("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#notes"},"Notes",-1)),ja=["hidden"],Ba={id:"notes",class:"collapse notes-menu"},Ra={class:"d-flex justify-content-between"},Ua={key:0,class:"selectable"},Va={key:1,class:"mdi mdi-eye text-success pe-3",title:"Everybody can see this Entity"},qa={class:"d-flex justify-content-around align-items-center fs-4"},Fa=m(()=>t("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#recaps"},"Recaps",-1)),za=["hidden"],Ha={id:"recaps",class:"collapse notes-menu"},Ja={key:0,class:"selectable"},Ma={class:"d-flex justify-content-around align-items-center fs-4"},Ta=m(()=>t("h1",{class:"selectable","data-bs-toggle":"collapse","data-bs-target":"#entities"},"Entities",-1)),Ya=["hidden"],Ga={id:"entities",class:"collapse notes-menu"},Ka={class:"d-flex justify-content-between"},Oa={key:0,class:"selectable"},Qa={key:1,class:"mdi mdi-eye text-success pe-3",title:"Everybody can see this Entity"},Wa=m(()=>t("h1",{class:"text-light mb-3"},"Search",-1));function Xa(o,n,g,a,b,c){var L,x,A,S,E,P,D,N,j,B,R,U,V,q,F,z,H;const w=G("router-view"),v=G("router-link");return i(),s("div",oa,[t("div",da,[t("div",ra,[(L=a.campaign)!=null&&L.discordLink?(i(),s("div",la,[t("a",{href:(x=a.campaign)==null?void 0:x.discordLink},_a,8,ma)])):((A=a.campaign)==null?void 0:A.creatorId)==a.account.id?(i(),s("div",ua,ha)):r("",!0)]),t("div",va,[t("div",fa,[t("h1",null,y((S=a.campaign)==null?void 0:S.name),1),((E=a.campaign)==null?void 0:E.isArchived)==!1?(i(),s("h2",ya,"Next Session Date: "+y(a.formattedDate),1)):(i(),s("h2",ka,"This Adventure Has Ended"))])]),t("div",ba,[((P=a.campaign)==null?void 0:P.creatorId)!=a.account.id&&!a.hasLink&&((D=a.campaign)==null?void 0:D.isArchived)==!1?(i(),s("button",{key:0,class:"btn btn-outline-danger",hidden:a.hasLink||((N=a.campaign)==null?void 0:N.partyCount)>=((j=a.campaign)==null?void 0:j.capacity)||!a.account.id,onClick:n[0]||(n[0]=e=>a.createAccountLink())},"Join Us!",8,Ia)):r("",!0),((B=a.campaign)==null?void 0:B.creatorId)==a.account.id&&((R=a.campaign)==null?void 0:R.isArchived)==!1?(i(),s("button",{key:1,onClick:n[1]||(n[1]=e=>a.archiveCampaign()),class:"btn btn-outline-info"},"Delete Campaign")):r("",!0)])]),t("div",Ca,[t("div",wa,[(i(!0),s(I,null,C(a.accountLinks,e=>{var d;return i(),s("div",{key:e.id},[t("img",{class:"player-avatar img-fluid",src:(d=e.Profile)==null?void 0:d.picture,alt:e.Profile.name,title:e.Profile.name},null,8,La)])}),128))])]),t("div",xa,[Aa,t("div",Sa,[t("div",null,[h(w)])]),t("div",Ea,[t("div",null,[h(v,{to:{name:"description"}},{default:k(()=>[Pa]),_:1})]),t("div",null,[t("div",Da,[Na,a.hasLink||((U=a.campaign)==null?void 0:U.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",hidden:((V=a.campaign)==null?void 0:V.isArchived)==!0,title:"Create a new Note",type:"button","data-bs-toggle":"modal","data-bs-target":"#createNote"},null,8,ja)):r("",!0)]),t("div",Ba,[(i(!0),s(I,null,C(a.notes,e=>{var d;return i(),s("ul",{class:"",key:e==null?void 0:e.id},[h(v,{to:{name:"notes",params:{campaignId:(d=a.campaign)==null?void 0:d.id,noteId:e==null?void 0:e.id}}},{default:k(()=>{var f;return[t("div",Ra,[e.isRecap==!1?(i(),s("li",Ua,y(e.name),1)):r("",!0),(e==null?void 0:e.accountId)==((f=a.account)==null?void 0:f.id)&&(e==null?void 0:e.isRecap)==!1?(i(),s("i",Va)):r("",!0)])]}),_:2},1032,["to"])])}),128))])]),t("div",null,[t("div",qa,[Fa,((q=a.campaign)==null?void 0:q.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",title:"Create a new Recap",hidden:((F=a.campaign)==null?void 0:F.isArchived)==!0,type:"button","data-bs-toggle":"modal","data-bs-target":"#createRecap"},null,8,za)):r("",!0)]),t("div",Ha,[(i(!0),s(I,null,C(a.notes,e=>{var d;return i(),s("ul",{key:e.id},[h(v,{to:{name:"notes",params:{campaignId:(d=a.campaign)==null?void 0:d.id,noteId:e==null?void 0:e.id}}},{default:k(()=>[e.isRecap==!0?(i(),s("li",Ja,y(e.name),1)):r("",!0)]),_:2},1032,["to"])])}),128))])]),t("div",null,[t("div",Ma,[Ta,((z=a.campaign)==null?void 0:z.creatorId)==a.account.id?(i(),s("i",{key:0,class:"mdi mdi-plus-circle selectable",title:"Add an Entity",hidden:((H=a.campaign)==null?void 0:H.isArchived)==!0,type:"button","data-bs-toggle":"modal","data-bs-target":"#addEntity"},null,8,Ya)):r("",!0)]),t("div",Ga,[(i(!0),s(I,null,C(a.entityLinks,e=>{var d;return i(),s("ul",{key:e.id},[h(v,{to:{name:"entities",params:{campaignId:(d=a.campaign)==null?void 0:d.id,entityId:e==null?void 0:e.id}}},{default:k(()=>{var f,J,M;return[t("div",Ka,[(e==null?void 0:e.isPrivate)==!1||((f=a.campaign)==null?void 0:f.creatorId)==((J=a.account)==null?void 0:J.id)?(i(),s("li",Oa,y(e.Entity.name),1)):r("",!0),e.isPrivate==!1&&((M=a.campaign)==null?void 0:M.creatorId)==a.account.id?(i(),s("i",Qa)):r("",!0)])]}),_:2},1032,["to"])])}),128))])]),t("div",null,[h(v,{to:{name:"search"}},{default:k(()=>[Wa]),_:1})])])])])}const $a=Q(na,[["render",Xa],["__scopeId","data-v-fc9ee395"]]);export{$a as default};
